 <div class="row">
    <div class="col-lg-3">
      <section class="panel">
        <div class="panel-body">  
          <p>Semana <?php echo $this->semana; echo ": ";?>
          <?php
            $fecha = $this->fecha;
            $newDate = date("Y-m-d", strtotime($fecha));
            $fechainicio = date ( 'd/m/Y' , strtotime($fecha) );
            $nuevafecha = strtotime ( '+6 day' , strtotime ( $newDate ) ) ;
            $fechafinal = date ( 'd/m/Y' , $nuevafecha );
            echo $fechainicio; echo " al "; echo $fechafinal;?></p>
        </div>
      </section>
    </div>
  <div class="col-lg-4">
    <section class="panel">
      <div class="panel-body" style="padding-bottom: 10px;padding-top: 12px;">
        <button data-toggle="button" class="btn btn-white">
          <i class=d"fa fa-thumbs-up text-info" style="color: #78CD51;"></i>
          <?php 
            $tareopersona = new Admin_Model_DbTable_Tareopersona();
            $sumar=$tareopersona-> _getHorasRealxTipo($this->semana,$this->uid,$this->dni,$this->cargo,'P');
            print_r($sumar[0]['tareo_persona_horas_reales_tipoactividad']); 
          ?>
        </button>
        <button data-toggle="button" class="btn btn-white">
          <i class="fa fa-thumbs-down text-info" style="color: #FF6C60;"></i>
          <?php 
            $tareopersona = new Admin_Model_DbTable_Tareopersona();
            $sumar=$tareopersona-> _getHorasRealxTipo($this->semana,$this->uid,$this->dni,$this->cargo,'G');
            print_r($sumar[0]['tareo_persona_horas_reales_tipoactividad']); 
          ?>
        </button>
        <button data-toggle="button" class="btn btn-white">
          <i class="fa fa-square text-info" style="color: #5bc0de;"></i>
          <?php 
            $tareopersona = new Admin_Model_DbTable_Tareopersona();
            $sumar=$tareopersona-> _getHorasRealxTipo($this->semana,$this->uid,$this->dni,$this->cargo,'');
            print_r($sumar[0]['tareo_persona_horas_reales_tipoactividad']); 
          ?>
        </button>
      </div>
    </section>
  </div>
  <div class="col-lg-5">
    <section class="panel">
      <div class="panel-body" style="padding-top: 10px;padding-bottom: 10px;">
        Aprobado por: Omar Morsss <br>
        Aprobado Gerente Generalddd
      </div>
    </section>
  </div>
</div>


<div class="row">
  <div class="col-sm-12">
    <section class="panel">
      <div class="panel-body">
        <div class="adv-table">
      
          <table  class="display table table-bordered table-striped">
          <thead>
            <tr >
            <th style="width: 5%;">  </th>
            <th style="width: 40%;" >Proyecto / Actividad: TareaSS</th>
            <th style="width: 7%;">Facturable</th>
            <th style="width: 12%;">Tarea No Facturable</th>
            <?php 
              $fecha = $this->fecha;
              $fecha_mostrar = $this->fecha_mostrar;
              $days_name = array("lun","mar","mié","jue","vie","sáb","dom");
              for ($i=0; $i < 7; $i++) { ?>
              <th style="width: 100px;"><center>
                <?php print $days_name[$i] ?> <br><?php 
                  list($dia, $mes, $anio) = split('[/.-]', $fecha);
                  print $dia ?></center></th>
                <?php
                  $newDate = date("Y-m-d", strtotime($fecha));
                  $nuevafecha = strtotime ( '+1 day' , strtotime ( $newDate ) ) ;
                  $fecha = date ( 'd-m-Y' , $nuevafecha );
                }?>
            </tr>
          </thead>
          <tbody>
          <?php 
            $fechaactual = $this->fecha;
            $fechaactual = date("Y-m-d", strtotime($fechaactual));
            $actividades = $this->actividades;
            $j=1;
            //for ($k=0; $k < 7; $k++){
            foreach ($actividades as $data_tareo) 
            { ?>
            <tr class="gradeX" id ="tr_tareo_<?php echo $j?>">
              <td> 
                <?php if ($data_tareo['tipo_actividad']=='G') {?>
                  <a id ="crear_tareag_<?php echo $j?>"><i class="fa fa-plus-square-o"></i></a>
                  <a title="Eliminar" id ="eliminar_tareo_<?php echo $j?>" ><i class="fa fa-minus-square-o"></i></a><?php }
                if ($data_tareo['tipo_actividad']=='P') { ?>
                  <a id ="crear_tareag_<?php echo $j?>" ><i class="fa fa-plus-square-o"></i></a>
                  <a title="Eliminar" id ="eliminar_tareo_<?php echo $j?>" ><i class="fa fa-minus-square-o"></i></a>                                   
                <?php }?>
              </td>
             
              <td>
                <?php echo $data_tareo['nombre_proyecto'];  echo " / "; echo $data_tareo['actividadid']; echo ": ";echo $data_tareo['nombre'] ?>
              </td>            

              <td>
                <?php if ($data_tareo['tipo_actividad']=='G') {?>
                  <a id ="nofacturable_cambio_<?php echo $j?>" class="btn btn-danger btn-xs ">No Facturable.</a>
                <?php }else{ ?>
                <a id ="facturable_tareo_<?php echo $j?>" class="btn btn-success btn-xs">Facturable</a>
                <a id ="nofacturable_tareo_<?php echo $j?>" class="btn btn-danger btn-xs" style="display:none">No Facturable</a>

                <?php }?>
              </td>            

              <td> 
                <?php if ($data_tareo['tipo_actividad']=='G') {
                  $dbactividadgeneral= new Admin_Model_DbTable_Actividadgeneral();
                  $datosactgeneral = $dbactividadgeneral->_getActividadgeneralxId($data_tareo['actividad_generalid']);
                 // print_r($datosactgeneral[0]['nombre']) 
                    if ($data_tareo['actividad_generalid']) 
                    { ?>
                        <select id="select_generalg_<?php echo $j?>" class="form-control input-sm m-bot15 col-lg-10">                        
                              <option value="<?php echo $data_tareo['actividad_generalid']?>"><?php print_r($datosactgeneral[0]['nombre']) ?></option>
                                  <?php 
                                      $areaid='25';
                                      $actividad_generales = new Admin_Model_DbTable_Actividadgeneral();
                                      $data_generales = $actividad_generales->_getActividadgeneralxArea($areaid);
                                      foreach ($data_generales as $data_tareas)
                                      { ?>
                                      <option value="<?php echo $data_tareas['actividad_generalid']?>"><?php  echo strtoupper($data_tareas['nombre'])?></option>
                                      <?php }?>
                        </select>
                      <?php
                    } 
                    else
                    {
                      ?>
                        <select id="select_generalg_<?php echo $j?>" class="form-control input-sm m-bot15 col-lg-10">                        
                          <option value="">Elija Tarea No Facturable</option>
                                      <?php 
                                          $areaid='25';
                                          $actividad_generales = new Admin_Model_DbTable_Actividadgeneral();
                                          $data_generales = $actividad_generales->_getActividadgeneralxArea($areaid);
                                          foreach ($data_generales as $data_tareas) {?>
                                          <option value="<?php echo $data_tareas['actividad_generalid']?>"><?php  echo strtoupper($data_tareas['nombre'])?></option>
                                      <?php }?>
                        </select>
                      <?php 
                    } ?>

                  <?php }

                  if ($data_tareo['tipo_actividad']=='P')
                  {  ?>
                    <div id="tarea_proyecto_<?php echo $j?>" >
                     <?php echo "< none >" ?>
                     </div>
                    <div id="tarea_general_<?php echo $j?>" style="display:none">

                    <select id="select_generalp_<?php echo $j?>" class="form-control input-sm m-bot15 col-lg-10">                        
                              <option value="">Seleccione Cliente</option>
                                  <?php 
                                      $areaid='25';
                                      $actividad_generales = new Admin_Model_DbTable_Actividadgeneral();
                                      $data_generales = $actividad_generales->_getActividadgeneralxArea($areaid);
                                      foreach ($data_generales as $data_tareas) {?>
                                      <option value="<?php echo $data_tareas['actividad_generalid']?>"><?php  echo strtoupper($data_tareas['nombre'])?></option>
                                  <?php }?>
                    </select>

                    <?php
                  }?>
              </td>

              <?php  $fecha = $this->fecha; 
              $fecha = date("Y-m-d", strtotime($fecha));
                for ($i=0; $i < 7; $i++) {
                $proyectoid=$data_tareo['proyectoid'];
                //  echo $proyectoid;echo "<br>";
                $codigo=$data_tareo['codigo_prop_proy'];
                // echo $codigo;echo "<br>";
                $revision=$data_tareo['revision'];
                //   echo $revision;echo "<br>";
                $actividadid=$data_tareo['actividadid'];
                //  echo $actividadid;echo "<br>";
                $actividad_padre=$data_tareo['actividad_padre'];
                //   echo $actividad_padre;echo "<br>";
                $semanaid=$data_tareo['semanaid'];
                $cadena=$data_tareo['etapa'];
                $resultado = str_replace("INICIO", "EJECUCION", $cadena);
                //  echo $semanaid;echo "<br>";
                $fecha_tarea=$fecha;
                // echo $fecha_tarea;echo "<br>";
                $fecha_planificacion=$fecha;
                // echo $fecha_planificacion;echo "<br>";
                $uid=$this->uid;
                // echo $uid;echo "<br>";
                $dni=$this->dni;
                //  echo $dni;echo "<br>";
               
                
                $equipo = new Admin_Model_DbTable_Equipo();
                $estado_usuario='A';
                $data_equipo = $equipo->_getDatosxProyectoxUidXEstadoxCliente($uid,$dni,$estado_usuario,$data_tareo['codigo_prop_proy'],$data_tareo['proyectoid']);
                $categoriaid=$data_equipo[0]['categoriaid'];
                $areaid=$data_equipo[0]['areaid'];
                $cargo=$data_equipo[0]['cargo'];
             

                // echo $cargo; echo "<br>";
                $tareopersona = new Admin_Model_DbTable_Tareopersona();
                $buscar_tarea=$tareopersona->_getTareoxProyectoxTareaxDia($proyectoid,$codigo,$revision,$actividadid,$actividad_padre,$semanaid,$fecha_tarea,$fecha_planificacion,$uid,$dni,$cargo,$resultado);
                //print_r($buscar_tarea);
                //$k=$a[$i][$j];
                ?>
              <td>
                <center>
                <!-- onBlur="fnc(event)" -->
                <!-- _<?php //echo $j?> -->            
                <!-- editable=true type="text" -->
                <!--             "<?php //echo $data_tareo['codigo_prop_proy']."!".$data_tareo['codigo_actividad']."!".$data_tareo['actividadid']."!".$data_tareo['revision']."!".$data_tareo['actividad_padre']."!".$data_tareo['proyectoid']."!".$data_tareo['semanaid']."!".$fecha."!".$data_tareo['asignado']."!".$data_tareo['areaid']."!".$data_tareo['categoriaid']."!".$data_tareo['dni']."!".$data_tareo['cargo']."!".$data_tareo['tipo_actividad']."!".$data_tareo['etapa']."!".$i."!".$data_tareo['actividad_generalid'];?>" -->

                <input  class="form-control" id="valor<?php echo $i?><?php echo $j?>" style="text-align: center;height: 26px; width: 40px; padding-right: 4px; padding-left: 4px;" maxlength="2" value="<?php 
                if ($buscar_tarea) {
                    if($buscar_tarea[0]['h_real']=='0') { echo "";} else { print_r($buscar_tarea[0]['h_real']);}
                    }?>" <?php if ($data_tareo['estado_tareopersona']=='C') {?> disabled <?php } ?> >


                        



                </center>

                <script type="text/javascript">
                  $(document).ready(function(){
                    $("#valor<?php echo $i ?><?php echo $j?>").keyup(function(e){ 
                        $("#valor<?php echo $i ?><?php echo $j?>").focus();

                        var hora_real=$("#valor<?php echo $i?><?php echo $j?>").val(); 
                        var codigo_prop_proy="<?php echo $data_tareo['codigo_prop_proy'] ?>";
                        var codigo_actividad="<?php echo $data_tareo['codigo_actividad'] ?>";
                        var actividadid="<?php echo $data_tareo['actividadid'] ?>";
                        var revision="<?php echo $data_tareo['revision'] ?>";
                        var actividad_padre="<?php echo $data_tareo['actividad_padre'] ?>";
                        var proyectoid="<?php echo $data_tareo['proyectoid'] ?>";
                        var semanaid="<?php echo $data_tareo['semanaid'] ?>";
                        var fecha_tarea ="<?php echo $fecha ?>";
                        var asignado="<?php echo $data_tareo['asignado'] ?>";
                        var areaid="<?php echo $data_tareo['areaid'] ?>";
                        var categoriaid ="<?php echo $data_tareo['categoriaid'] ?>";
                        var dni="<?php echo $data_tareo['dni'] ?>";
                        var cargo="<?php echo $data_tareo['cargo'] ?>";

                        
                        var tipo_actividad="<?php echo $data_tareo['tipo_actividad'] ?>";
                        var etapa="<?php echo $data_tareo['etapa'] ?>";                        
                        var actividad_generalid="<?php echo $data_tareo['actividad_generalid'] ?>";
                        var h_propuesta="<?php echo $data_tareo['h_propuesta'] ?>";
                       var fecha_calendario = $("#fechasemana").text();
                        
                        var uid="<?php echo $this->uid ?>";
                        var dni_="<?php echo $this->dni ?>";
                        var fechainiciomod="<?php echo $this->fecha_inicio_mod ?>";
                        var fecha="<?php echo $this->fecha ?>";
                        var fechaz="<?php echo $data_tareo['fecha_tarea'] ?>";
                        


                        if (isNaN(hora_real)) {
                           //entonces (no es numero) devuelvo el valor cadena vacia 
                           alert('la hora no puede ser una letra');
                           //e.preventDefault();
                        }else{ 
                           //En caso contrario (Si era un número) devuelvo el valor 
                          var url="/timesheet/index/updatetareoreal/codigo_prop_proy/"+codigo_prop_proy+"/codigo_actividad/"+codigo_actividad+"/actividadid/"+actividadid+"/revision/"+revision+"/actividad_padre/"+actividad_padre+"/proyectoid/"+proyectoid+"/semanaid/"+semanaid+"/fecha_tarea/"+fecha_tarea+"/asignado/"+asignado+"/areaid/"+areaid+"/categoriaid/"+categoriaid+"/dni/"+dni+"/cargo/"+cargo+"/horareal/"+hora_real+"/tipo_actividad/"+tipo_actividad+"/etapa/"+etapa+"/actividad_generalid/"+actividad_generalid+"/fecha_calendario/"+fecha_calendario+"/h_propuesta/"+h_propuesta;   

                          var url2='/timesheet/index/traersumahoras/semanaid/'+semanaid+'/fecha/'+fecha_tarea+'/fechainiciomod/'+fecha_tarea+'/uid/'+uid+'/dni/'+dni_+'/cargo/'+cargo;   
                          //alert(url);            

                           $.ajax({
                                    type: "POST",
                                    url: url,
                                    data: $(this).serialize(),
                                    dataType: "html",                                                 
                                    error: function(){
                                          alert("error petición ajax load");
                                    },
                                    success: function(data){                                                 
                                          $("#carga").empty();
                                          $("#carga").append(data);                                          

                                              $.ajax({
                                                    type: "POST",
                                                    url: url2,
                                                    data: $(this).serialize(),
                                                    dataType: "html",                                                 
                                                    error: function(){
                                                      alert("error petición ajax load");
                                                    },
                                                    success: function(data){      
                                                      //console.log('agg');                                              
                                                      $("#sumahoras<?php echo $i ?>").empty();
                                                      $("#sumahoras<?php echo $i ?>").append(data);                                     
                                                      $("#fecha_<?php echo $i?>").hide();                 
                                                    }
                                              });                                          
                                    }
                            });
                        } 
                      });
                    });
                </script>


              </td>
                <?php 
                  $newDate = date("Y-m-d", strtotime($fecha));
                  $nuevafecha = strtotime ( '+1 day' , strtotime ( $newDate ) ) ;
                  $fecha = date ( 'Y-m-d' , $nuevafecha );?>
                <?php }
                ?>


            </tr>

              <script type="text/javascript">
                $("#select_generalp_<?php echo $j?>").change(function(){
                  var tarea_general = $(this).val(); 
                  //alert(tarea_general);
                  //alert('1');
                   var codigo_prop_proy= '<?php echo $data_tareo['codigo_prop_proy']?>';
                    var codigo_actividad='<?php echo $data_tareo['codigo_actividad']?>';
                    var actividadid="<?php echo $data_tareo['actividadid']?>";
                    var revision="<?php echo $data_tareo['revision']?>";
                    var actividad_padre="<?php echo $data_tareo['actividad_padre'] ?>";
                    var proyectoid="<?php echo $data_tareo['proyectoid']?>";
                    var semanaid="<?php echo $data_tareo['semanaid']?>";
                    var fecha_tarea="<?php echo $data_tareo['fecha_tarea'] ?>";
                    var asignado="<?php echo $data_tareo['asignado']?>";
                    var areaid="<?php echo $data_tareo['areaid']?>";
                    var categoriaid="<?php echo $data_tareo['categoriaid']?>";
                    var dni="<?php echo $data_tareo['dni']?>";
                    var cargo="<?php echo $data_tareo['cargo']?>";
                    var etapa="<?php echo $data_tareo['etapa']?>";
                    var tipo_actividad="<?php echo $data_tareo['tipo_actividad']?>";
                    var fecha_planificacion="<?php echo $data_tareo['fecha_planificacion']?>";
                    var fecha = $("#fechasemana").text();

                    var url="/timesheet/index/updateetapanb/codigo/"+codigo_prop_proy+"/codigo_actividad/"+codigo_actividad+"/actividadid/"+actividadid+"/revision/"+revision+"/actividad_padre/"+actividad_padre+"/proyectoid/"+proyectoid+"/semanaid/"+semanaid+"/fecha_tarea/"+fecha_tarea+"/asignado/"+asignado+"/areaid/"+areaid+"/categoriaid/"+categoriaid+"/dni/"+dni+"/cargo/"+cargo+"/tipo_actividad/"+tipo_actividad+"/etapa/"+etapa+"/fecha_planificacion/"+fecha_planificacion+"/tarea_general/"+tarea_general+"/fecha/"+fecha;


                    //alert(url);
                    //$("#carga").load(url);
                    var dateObj = new Date();
                    var dateFrom = $.datepicker.formatDate('mm/dd/yy', dateObj);
                    var weekfrom = $.datepicker.iso8601Week(new Date(dateFrom));
                    var diasSemana = new Array("Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado");
                    var day_select = diasSemana[dateObj.getDay()];
                    for (i = 0; i < diasSemana.length; i++) { 
                      if (diasSemana[i] == day_select) {
                        if (i == 0) {
                          var num_day = 6;
                        } else {
                          var num_day = i - 1;
                        };
                      };
                    };
                    fecha_inicio = mostrarFecha(dateObj,-num_day);
                    //$("#registros").load("/timesheet/index/registro/fecha/" + fecha_inicio); 
                       //document.location.href="/timesheet/index/calendar";
                    $.ajax({
                        type: "POST",
                        url: url,
                        data: $(this).serialize(),
                        dataType: "html",                                                 
                        error: function(){
                              alert("error petición ajax load");
                        },
                        success: function(data){      
                                $("#carga").html(data);     
                        }
                    });    
                    //$("#carga").load(url);

                });

                $("#select_generalg_<?php echo $j?>").change(function(){
                  var tarea_general = $(this).val(); 
                  //alert(tarea_general);
                 //alert("2");
                  var codigo_prop_proy= '<?php echo $data_tareo['codigo_prop_proy']?>';
                    var codigo_actividad='<?php echo $data_tareo['codigo_actividad']?>';
                    var actividadid="<?php echo $data_tareo['actividadid']?>";
                    var revision="<?php echo $data_tareo['revision']?>";
                    var actividad_padre="<?php echo $data_tareo['actividad_padre'] ?>";
                    var proyectoid="<?php echo $data_tareo['proyectoid']?>";
                    var semanaid="<?php echo $data_tareo['semanaid']?>";
                    var fecha_tarea="<?php echo $data_tareo['fecha_tarea'] ?>";
                    var asignado="<?php echo $data_tareo['asignado']?>";
                    var areaid="<?php echo $data_tareo['areaid']?>";
                    var categoriaid="<?php echo $data_tareo['categoriaid']?>";
                    var dni="<?php echo $data_tareo['dni']?>";
                    var cargo="<?php echo $data_tareo['cargo']?>";
                    var etapa="<?php echo $data_tareo['etapa']?>";
                    var tipo_actividad="<?php echo $data_tareo['tipo_actividad']?>";
                    var fecha_planificacion="<?php echo $data_tareo['fecha_planificacion']?>";
                    var fecha = $("#fechasemana").text();

                    var url="/timesheet/index/updateetapanb/codigo/"+codigo_prop_proy+"/codigo_actividad/"+codigo_actividad+"/actividadid/"+actividadid+"/revision/"+revision+"/actividad_padre/"+actividad_padre+"/proyectoid/"+proyectoid+"/semanaid/"+semanaid+"/fecha_tarea/"+fecha_tarea+"/asignado/"+asignado+"/areaid/"+areaid+"/categoriaid/"+categoriaid+"/dni/"+dni+"/cargo/"+cargo+"/tipo_actividad/"+tipo_actividad+"/etapa/"+etapa+"/fecha_planificacion/"+fecha_planificacion+"/tarea_general/"+tarea_general+"/fecha/"+fecha;
                     //alert(url);
                   
                    if (isNaN(tarea_general)) {
                           //entonces (no es numero) devuelvo el valor cadena vacia 
                           alert('la actividad esta duplicada, cargue nuevamente la pagina');
                           //e.preventDefault();
                    }else{ 

                    var dateObj = new Date();
                    var dateFrom = $.datepicker.formatDate('mm/dd/yy', dateObj);
                    var weekfrom = $.datepicker.iso8601Week(new Date(dateFrom));
                    var diasSemana = new Array("Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado");
                    var day_select = diasSemana[dateObj.getDay()];
                    for (i = 0; i < diasSemana.length; i++) { 
                      if (diasSemana[i] == day_select) {
                        if (i == 0) {
                          var num_day = 6;
                        } else {
                          var num_day = i - 1;
                        };
                      };
                    };
                    fecha_inicio = mostrarFecha(dateObj,-num_day);
                  //  $("#registros").load("/timesheet/index/registro/fecha/" + fecha_inicio); 
                    //document.location.href="/timesheet/index/calendar";
                    $.ajax({
                        type: "POST",
                        url: url,
                        data: $(this).serialize(),
                        dataType: "html",                                                 
                        error: function(){
                              alert("error petición ajax load");
                        },
                        success: function(data){      
                                $("#carga").html(data);     
                        }
                    });    

                    urlfecha="/timesheet/index/registro/fecha/" + fecha_inicio

                     $.ajax({
                        type: "POST",
                        url: urlfecha,
                        data: $(this).serialize(),
                        dataType: "html",                                                 
                        error: function(){
                              alert("error petición ajax load");
                        },
                        success: function(data){      
                                $("#registro").html(data);     
                        }
                    });    

                    //$("#carga").load(url);
                    //$("#registro").load();
                  }
                }); 
                

                $(document).ready(function(){
                  $("#nofacturable_cambio_<?php echo $j?>").click(function(){
                    //alert("ssss");
                    //$("#tarea_general_<?php echo $j?>").show();
                    //$("#facturable_tareo_<?php echo $j?>").hide();
                    //$("#nofacturable_tareo_<?php echo $j?>").show();
                    //$("#tarea_proyecto_<?php echo $j?>").hide();                   
                    var codigo_prop_proy= "<?php echo $data_tareo['codigo_prop_proy']?>";
                    var codigo_actividad="<?php echo $data_tareo['codigo_actividad']?>";
                    var actividadid="<?php echo $data_tareo['actividadid']?>";
                    var revision="<?php echo $data_tareo['revision']?>";
                    var actividad_padre="<?php echo $data_tareo['actividad_padre'] ?>";
                    var proyectoid="<?php echo $data_tareo['proyectoid']?>";
                    var semanaid="<?php echo $data_tareo['semanaid']?>";
                    var fecha_tarea="<?php echo $data_tareo['fecha_tarea'] ?>";
                    var asignado="<?php echo $data_tareo['asignado']?>";
                    var areaid="<?php echo $data_tareo['areaid']?>";
                    var categoriaid="<?php echo $data_tareo['categoriaid']?>";
                    var dni="<?php echo $data_tareo['dni']?>";
                    var cargo="<?php echo $data_tareo['cargo']?>";
                    var etapa="<?php echo $data_tareo['etapa']?>";
                    var tipo_actividad="<?php echo $data_tareo['tipo_actividad']?>";
                    var fecha_planificacion="<?php echo $data_tareo['fecha_planificacion']?>";
                    var fecha = $("#fechasemana").text();

                    var url="/timesheet/index/updateetapab/codigo/"+codigo_prop_proy+"/codigo_actividad/"+codigo_actividad+"/actividadid/"+actividadid+"/revision/"+revision+"/actividad_padre/"+actividad_padre+"/proyectoid/"+proyectoid+"/semanaid/"+semanaid+"/fecha_tarea/"+fecha_tarea+"/asignado/"+asignado+"/areaid/"+areaid+"/categoriaid/"+categoriaid+"/dni/"+dni+"/cargo/"+cargo+"/tipo_actividad/"+tipo_actividad+"/etapa/"+etapa+"/fecha_planificacion/"+fecha_planificacion+"/fecha/"+fecha;
                    // alert(url);
                   
                     var dateObj = new Date();
                    var dateFrom = $.datepicker.formatDate('mm/dd/yy', dateObj);
                    var weekfrom = $.datepicker.iso8601Week(new Date(dateFrom));
                    var diasSemana = new Array("Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado");
                    var day_select = diasSemana[dateObj.getDay()];
                    for (i = 0; i < diasSemana.length; i++) { 
                      if (diasSemana[i] == day_select) {
                        if (i == 0) {
                          var num_day = 6;
                        } else {
                          var num_day = i - 1;
                        };
                      };
                    };
                    fecha_inicio = mostrarFecha(dateObj,-num_day);

                    $.ajax({
                        type: "POST",
                        url: url,
                        data: $(this).serialize(),
                        dataType: "html",                                                 
                        error: function(){
                              alert("error petición ajax load");
                        },
                        success: function(data){      
                                $("#carga").html(data);     
                        }
                    });    

                    urlfecha="/timesheet/index/registro/fecha/" + fecha_inicio;

                    $.ajax({
                        type: "POST",
                        url: urlfecha,
                        data: $(this).serialize(),
                        dataType: "html",                                                 
                        error: function(){
                              alert("error petición ajax load");
                        },
                        success: function(data){      
                                $("#registro").html(data);     
                        }
                    });  
                    //$("#carga").load(url);
                    //$("#registro").load(); 

                  });
                });


                $(document).ready(function(){
                  $("#facturable_tareo_<?php echo $j?>").click(function(){


                    var codigo_prop_proy= "<?php echo $data_tareo['codigo_prop_proy']?>";
                    var codigo_actividad="<?php echo $data_tareo['codigo_actividad']?>";
                    var actividadid="<?php echo $data_tareo['actividadid']?>";
                    var revision="<?php echo $data_tareo['revision']?>";
                    var actividad_padre="<?php echo $data_tareo['actividad_padre'] ?>";
                    var proyectoid="<?php echo $data_tareo['proyectoid']?>";
                    var semanaid="<?php echo $data_tareo['semanaid']?>";
                    var fecha_tarea="<?php echo $data_tareo['fecha_tarea'] ?>";
                    var asignado="<?php echo $data_tareo['asignado']?>";
                    var areaid="<?php echo $data_tareo['areaid']?>";
                    var categoriaid="<?php echo $data_tareo['categoriaid']?>";
                    var dni="<?php echo $data_tareo['dni']?>";
                    var cargo="<?php echo $data_tareo['cargo']?>";
                    var etapa="<?php echo $data_tareo['etapa']?>";
                    var tipo_actividad="<?php echo $data_tareo['tipo_actividad']?>";
                    var fecha_planificacion="<?php echo $data_tareo['fecha_planificacion']?>";
                    var fecha = $("#fechasemana").text();

                    var url="/timesheet/index/updateetapanb/codigo/"+codigo_prop_proy+"/codigo_actividad/"+codigo_actividad+"/actividadid/"+actividadid+"/revision/"+revision+"/actividad_padre/"+actividad_padre+"/proyectoid/"+proyectoid+"/semanaid/"+semanaid+"/fecha_tarea/"+fecha_tarea+"/asignado/"+asignado+"/areaid/"+areaid+"/categoriaid/"+categoriaid+"/dni/"+dni+"/cargo/"+cargo+"/tipo_actividad/"+tipo_actividad+"/etapa/"+etapa+"/fecha_planificacion/"+fecha_planificacion+"/fecha/"+fecha;

                    // var url="/timesheet/index/guardaractividadgeneral/codigo/"+codigo_prop_proy+"/codigo_actividad/"+codigo_actividad+"/actividadid/"+actividadid+"/revision/"+revision+"/actividad_padre/"+actividad_padre+"/proyectoid/"+proyectoid+"/semanaid/"+semanaid+"/fecha_tarea/"+fecha_tarea+"/asignado/"+asignado+"/areaid/"+areaid+"/categoriaid/"+categoriaid+"/dni/"+dni+"/cargo/"+cargo+"/tipo_actividad/"+tipo_actividad+"/etapa/"+etapa+"/fecha_planificacion/"+fecha_planificacion+"/fecha/"+fecha;

                    //alert(" facturable tareo k kambie ");
                    //alert(url);

                    $.ajax({
                        type: "POST",
                        url: url,
                        data: $(this).serialize(),
                        dataType: "html",                                                 
                        error: function(){
                              alert("error petición ajax load");
                        },
                        success: function(data){      
                              $("#carga").html(data);
                          
                        }
                    });

                    var dateObj = new Date();
                    var dateFrom = $.datepicker.formatDate('mm/dd/yy', dateObj);
                    var weekfrom = $.datepicker.iso8601Week(new Date(dateFrom));
                    var diasSemana = new Array("Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado");
                    var day_select = diasSemana[dateObj.getDay()];
                    for (i = 0; i < diasSemana.length; i++) { 
                      if (diasSemana[i] == day_select) {
                        if (i == 0) {
                          var num_day = 6;
                        } else {
                          var num_day = i - 1;
                        };
                      };
                    };
                    fecha_inicio = mostrarFecha(dateObj,-num_day);

                    urlfecha="/timesheet/index/registro/fecha/" + fecha_inicio;

                    $.ajax({
                        type: "POST",
                        url: urlfecha,
                        data: $(this).serialize(),
                        dataType: "html",                                                 
                        error: function(){
                              alert("error petición ajax load");
                        },
                        success: function(data){      
                                $("#registro").html(data);
                              
                        }
                    });  

                      $("#facturable_tareo_<?php echo $j?>").hide();
                      $("#tarea_general_<?php echo $j?>").show();
                      $("#nofacturable_tareo_<?php echo $j?>").show();                 
                    // var codigo_prop_proy= '<?php echo $data_tareo['codigo_prop_proy']?>';
                    // var codigo_actividad='<?php echo $data_tareo['codigo_actividad']?>';
                    // var actividadid="<?php echo $data_tareo['actividadid']?>";
                    // var revision="<?php echo $data_tareo['revision']?>";
                    // var actividad_padre="<?php echo $data_tareo['actividad_padre'] ?>";
                    // var proyectoid="<?php echo $data_tareo['proyectoid']?>";
                    // var semanaid="<?php echo $data_tareo['semanaid']?>";
                    // var fecha_tarea="<?php echo $data_tareo['fecha_tarea'] ?>";
                    // var asignado="<?php echo $data_tareo['asignado']?>";
                    // var areaid="<?php echo $data_tareo['areaid']?>";
                    // var categoriaid="<?php echo $data_tareo['categoriaid']?>";
                    // var dni="<?php echo $data_tareo['dni']?>";
                    // var cargo="<?php echo $data_tareo['cargo']?>";
                    // var etapa="<?php echo $data_tareo['etapa']?>";
                    // var tipo_actividad="<?php echo $data_tareo['tipo_actividad']?>";
                    // var fecha_planificacion="<?php echo $data_tareo['fecha_planificacion']?>";
                    // var url="/timesheet/index/guardaractividadgeneral/codigo/"+codigo_prop_proy+"/codigo_actividad/"+codigo_actividad+"/actividadid/"+actividadid+"/revision/"+revision+"/actividad_padre/"+actividad_padre+"/proyectoid/"+proyectoid+"/semanaid/"+semanaid+"/fecha_tarea/"+fecha_tarea+"/asignado/"+asignado+"/areaid/"+areaid+"/categoriaid/"+categoriaid+"/dni/"+dni+"/cargo/"+cargo+"/tipo_actividad/"+tipo_actividad+"/etapa/"+etapa+"/fecha_planificacion/"+fecha_planificacion;
                    // alert(url);
                    // $("#carga").load(url);
                  });
                });

                $(document).ready(function(){
                  $("#nofacturable_tareo_<?php echo $j?>").click(function(){

                    $("#facturable_tareo_<?php echo $j?>").show();
                    $("#tarea_general_<?php echo $j?>").hide();
                    $("#nofacturable_tareo_<?php echo $j?>").hide();  

                    // var codigo_prop_proy= '<?php echo $data_tareo['codigo_prop_proy']?>';
                    // var codigo_actividad='<?php echo $data_tareo['codigo_actividad']?>';
                    // var actividadid="<?php echo $data_tareo['actividadid']?>";
                    // var revision="<?php echo $data_tareo['revision']?>";
                    // var actividad_padre="<?php echo $data_tareo['actividad_padre'] ?>";
                    // var proyectoid="<?php echo $data_tareo['proyectoid']?>";
                    // var semanaid="<?php echo $data_tareo['semanaid']?>";
                    // var fecha_tarea="<?php echo $data_tareo['fecha_tarea'] ?>";
                    // var asignado="<?php echo $data_tareo['asignado']?>";
                    // var areaid="<?php echo $data_tareo['areaid']?>";
                    // var categoriaid="<?php echo $data_tareo['categoriaid']?>";
                    // var dni="<?php echo $data_tareo['dni']?>";
                    // var cargo="<?php echo $data_tareo['cargo']?>";
                    // var etapa="<?php echo $data_tareo['etapa']?>";
                    // var tipo_actividad="<?php echo $data_tareo['tipo_actividad']?>";
                    // var fecha_planificacion="<?php echo $data_tareo['fecha_planificacion']?>";
                    // var url="/timesheet/index/guardaractividadgeneral/codigo/"+codigo_prop_proy+"/codigo_actividad/"+codigo_actividad+"/actividadid/"+actividadid+"/revision/"+revision+"/actividad_padre/"+actividad_padre+"/proyectoid/"+proyectoid+"/semanaid/"+semanaid+"/fecha_tarea/"+fecha_tarea+"/asignado/"+asignado+"/areaid/"+areaid+"/categoriaid/"+categoriaid+"/dni/"+dni+"/cargo/"+cargo+"/tipo_actividad/"+tipo_actividad+"/etapa/"+etapa+"/fecha_planificacion/"+fecha_planificacion;
                    // alert(url);
                    //$("#carga").load(url);


                    /*codigo wwalter
                    var codigo_prop_proy= "<?php echo $data_tareo['codigo_prop_proy']?>";
                    var codigo_actividad="<?php echo $data_tareo['codigo_actividad']?>";
                    var actividadid="<?php echo $data_tareo['actividadid']?>";
                    var revision="<?php echo $data_tareo['revision']?>";
                    var actividad_padre="<?php echo $data_tareo['actividad_padre'] ?>";
                    var proyectoid="<?php echo $data_tareo['proyectoid']?>";
                    var semanaid="<?php echo $data_tareo['semanaid']?>";
                    var fecha_tarea="<?php echo $data_tareo['fecha_tarea'] ?>";
                    var asignado="<?php echo $data_tareo['asignado']?>";
                    var areaid="<?php echo $data_tareo['areaid']?>";
                    var categoriaid="<?php echo $data_tareo['categoriaid']?>";
                    var dni="<?php echo $data_tareo['dni']?>";
                    var cargo="<?php echo $data_tareo['cargo']?>";
                    var etapa="<?php echo $data_tareo['etapa']?>";
                    var tipo_actividad="<?php echo $data_tareo['tipo_actividad']?>";
                    var fecha_planificacion="<?php echo $data_tareo['fecha_planificacion']?>";
                    var fecha = $("#fechasemana").text();

                    var url="/timesheet/index/updateetapab/codigo/"+codigo_prop_proy+"/codigo_actividad/"+codigo_actividad+"/actividadid/"+actividadid+"/revision/"+revision+"/actividad_padre/"+actividad_padre+"/proyectoid/"+proyectoid+"/semanaid/"+semanaid+"/fecha_tarea/"+fecha_tarea+"/asignado/"+asignado+"/areaid/"+areaid+"/categoriaid/"+categoriaid+"/dni/"+dni+"/cargo/"+cargo+"/tipo_actividad/"+tipo_actividad+"/etapa/"+etapa+"/fecha_planificacion/"+fecha_planificacion+"/fecha/"+fecha;

                    alert(" no facturable tareo ");
                    alert(url);

                    $.ajax({
                        type: "POST",
                        url: url,
                        data: $(this).serialize(),
                        dataType: "html",                                                 
                        error: function(){
                              alert("error petición ajax load");
                        },
                        success: function(data){      
                              $("#carga").html(data);
                                
                        }
                    });

                    var dateObj = new Date();
                    var dateFrom = $.datepicker.formatDate('mm/dd/yy', dateObj);
                    var weekfrom = $.datepicker.iso8601Week(new Date(dateFrom));
                    var diasSemana = new Array("Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado");
                    var day_select = diasSemana[dateObj.getDay()];
                    for (i = 0; i < diasSemana.length; i++) { 
                      if (diasSemana[i] == day_select) {
                        if (i == 0) {
                          var num_day = 6;
                        } else {
                          var num_day = i - 1;
                        };
                      };
                    };
                    fecha_inicio = mostrarFecha(dateObj,-num_day);

                    urlfecha="/timesheet/index/registro/fecha/" + fecha_inicio;

                    $.ajax({
                        type: "POST",
                        url: urlfecha,
                        data: $(this).serialize(),
                        dataType: "html",                                                 
                        error: function(){
                              alert("error petición ajax load");
                        },
                        success: function(data){      
                                $("#registro").html(data);     
                        }
                    });  
                    
*/

                  });
                });

                $(document).ready(function(){
                  $("#crear_tareag_<?php echo $j?>").click(function(){

                    //alert('sssszzzz');
                    var codigo_prop_proy= '<?php echo $data_tareo['codigo_prop_proy']?>';
                    var codigo_actividad='<?php echo $data_tareo['codigo_actividad']?>';
                    var actividadid="<?php echo $data_tareo['actividadid']?>";
                    var revision="<?php echo $data_tareo['revision']?>";
                    var actividad_padre="<?php echo $data_tareo['actividad_padre'] ?>";
                    var proyectoid="<?php echo $data_tareo['proyectoid']?>";
                    var semanaid="<?php echo $data_tareo['semanaid']?>";
                    var fecha_tarea="<?php echo $data_tareo['fecha_tarea'] ?>";
                    var asignado="<?php echo $data_tareo['asignado']?>";
                    var areaid="<?php echo $data_tareo['areaid']?>";
                    var categoriaid="<?php echo $data_tareo['categoriaid']?>";
                    var dni="<?php echo $data_tareo['dni']?>";
                    var cargo="<?php echo $data_tareo['cargo']?>";
                    var etapa="<?php echo $data_tareo['etapa']?>";
                    var tipo_actividad="<?php echo $data_tareo['tipo_actividad']?>";
                    var fecha_planificacion="<?php echo $data_tareo['fecha_planificacion']?>";
                     var fecha = $("#fechasemana").text();

                    var url="/timesheet/index/guardaractividadgeneral/codigo/"+codigo_prop_proy+"/codigo_actividad/"+codigo_actividad+"/actividadid/"+actividadid+"/revision/"+revision+"/actividad_padre/"+actividad_padre+"/proyectoid/"+proyectoid+"/semanaid/"+semanaid+"/fecha_tarea/"+fecha_tarea+"/asignado/"+asignado+"/areaid/"+areaid+"/categoriaid/"+categoriaid+"/dni/"+dni+"/cargo/"+cargo+"/tipo_actividad/"+tipo_actividad+"/etapa/"+etapa+"/fecha_planificacion/"+fecha_planificacion+"/fecha/"+fecha;
                     //alert(url);
                     //$("#carga_nueva").load(url);
                      $.ajax({
                        type: "POST",
                        url: url,
                        data: $(this).serialize(),
                        dataType: "html",                                                 
                        error: function(){
                              alert("error petición ajax load");
                        },
                        success: function(data){      
                                $("#carga_nueva").html(data);     
                        }
                      });                

                    var dateObj = new Date();
                    var dateFrom = $.datepicker.formatDate('mm/dd/yy', dateObj);
                    var weekfrom = $.datepicker.iso8601Week(new Date(dateFrom));
                    var diasSemana = new Array("Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado");
                    var day_select = diasSemana[dateObj.getDay()];
                    for (i = 0; i < diasSemana.length; i++) { 
                      if (diasSemana[i] == day_select) {
                        if (i == 0) {
                          var num_day = 6;
                        } else {
                          var num_day = i - 1;
                        };
                      };
                    };

                    fecha_inicio = mostrarFecha(dateObj,-num_day);
                    urlfecha="/timesheet/index/registro/fecha/" + fecha_inicio;
                    //alert(urlfecha);
                    //$("#registro").load(urlfecha);
                        $.ajax({
                        type: "POST",
                        url: urlfecha,
                        data: $(this).serialize(),
                        dataType: "html",                                                 
                        error: function(){
                              alert("error petición ajax load");
                        },
                        success: function(data){      
                                $("#registro").html(data);     
                        }
                      });                


                  });
                });
            

                $(document).ready(function(){
                  $("#eliminar_tareo_<?php echo $j?>").click(function(){
                    //$("#tr_tareo_<?php echo $j?>").hide();
                    var codigo_prop_proy= '<?php echo $data_tareo['codigo_prop_proy']?>';
                    var codigo_actividad='<?php echo $data_tareo['codigo_actividad']?>';
                    var actividadid="<?php echo $data_tareo['actividadid']?>";
                    var revision="<?php echo $data_tareo['revision']?>";
                    var actividad_padre="<?php echo $data_tareo['actividad_padre'] ?>";
                    var proyectoid="<?php echo $data_tareo['proyectoid']?>";
                    var semanaid="<?php echo $data_tareo['semanaid']?>";
                    var fecha_tarea="<?php echo $data_tareo['fecha_tarea'] ?>";
                    var asignado="<?php echo $data_tareo['asignado']?>";
                    var areaid="<?php echo $data_tareo['areaid']?>";
                    var categoriaid="<?php echo $data_tareo['categoriaid']?>";
                    var dni="<?php echo $data_tareo['dni']?>";
                    var cargo="<?php echo $data_tareo['cargo']?>";
                    var etapa="<?php echo $data_tareo['etapa']?>";
                    var tipo_actividad="<?php echo $data_tareo['tipo_actividad']?>";
                    var fecha_planificacion="<?php echo $data_tareo['fecha_planificacion']?>";
                    var actividad_generalid="<?php echo $data_tareo['actividad_generalid']?>";
                    
                    
                    var url="/timesheet/index/eliminartareo/codigo/"+codigo_prop_proy+"/codigo_actividad/"+codigo_actividad+"/actividadid/"+actividadid+"/revision/"+revision+"/actividad_padre/"+actividad_padre+"/proyectoid/"+proyectoid+"/semanaid/"+semanaid+"/fecha_tarea/"+fecha_tarea+"/asignado/"+asignado+"/areaid/"+areaid+"/categoriaid/"+categoriaid+"/dni/"+dni+"/cargo/"+cargo+"/tipo_actividad/"+tipo_actividad+"/etapa/"+etapa+"/fecha_planificacion/"+fecha_planificacion+"/actividad_generalid/"+actividad_generalid;
                    var r = confirm("Desea Eliminar esta tarea!");
                    if (r == true) {
                     // $("#tr_tareo_<?php echo $j?>").hide();
                    //alert(url);
                    //e.preventDefault;
                    $.ajax({
                        type: "POST",
                        url: url,
                        data: $(this).serialize(),
                        dataType: "html",
                        success: function(data){      
                            $("#carga_nueva").html(data);     
                        }
                    });

                    //$("#carga_nueva").load(url);
                    var dateObj = new Date();
                    var dateFrom = $.datepicker.formatDate('mm/dd/yy', dateObj);
                    var weekfrom = $.datepicker.iso8601Week(new Date(dateFrom));
                    var diasSemana = new Array("Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado");
                    var day_select = diasSemana[dateObj.getDay()];
                    for (i = 0; i < diasSemana.length; i++) { 
                      if (diasSemana[i] == day_select) {
                        if (i == 0) {
                          var num_day = 6;
                        } else {
                          var num_day = i - 1;
                        };
                      };
                    };
                    fecha_inicio = mostrarFecha(dateObj,-num_day);
                     //document.location.href="/timesheet/index/calendar";
                    urlfecha="/timesheet/index/registro/fecha/" + fecha_inicio;
                    $.ajax({
                        type: "POST",
                        url: urlfecha,
                        data: $(this).serialize(),
                        dataType: "html",
                        success: function(data){      
                            $("#registro").html(data);     
                        }
                    });
                    //$("#registro").load();
                    }
                  });
                });
              </script>

            <?php $j++;
             //}
            }?>
           </tbody>
          
           <?php if ( $this->actividades) {?>
          <tr >
            <th style="width: 5%;">  </th>
            <th style="width: 22%;" > </th>
            <th style="width: 13%;"> </th>
            <th style="width: 27%;"> </th>
            <?php 
              $uid=$this->uid;
                // echo $uid;echo "<br>";
              $dni=$this->dni;
              $fecha = $this->fecha;
              $fecha = date("Y-m-d", strtotime($fecha));
              for ($i=0; $i < 7; $i++) { ?>
              <th style="width: 100px;">
                <center>

                    <div id="fecha_<?php echo $i?>">
                    <?php  $tareopersona = new Admin_Model_DbTable_Tareopersona();
                    $sumar=$tareopersona-> _getHorasRealxDia($data_tareo['semanaid'],$fecha,$uid,$dni,$data_tareo['cargo']);
                    print_r($sumar[0]['tareo_persona_horas_reales']); ?>
                    </div>

                  <!-- <div id="fecha_<?php //echo $i?>"> -->
                  <?php                
                  // $wheres=array('dni'=>$dni,'uid'=>$uid,'cargo'=>$data_tareo['cargo'],'semanaid'=>$data_tareo['semanaid'],'fecha_tarea'=>$fecha);
                  // $sumhora=  new  Admin_Model_DbTable_Sumahora();
                  // $sh=$sumhora->_getOne($wheres);
                  // print_r($sh['h_totaldia']);
                  ?>
                  <!-- </div> -->

                </center>

                <center><div id="sumahoras<?php echo $i ?>"></div></center>

              </th>
                <?php
                  $newDate = date("Y-m-d", strtotime($fecha));
                  $nuevafecha = strtotime ( '+1 day' , strtotime ( $newDate ) ) ;
                  $fecha = date ( 'Y-m-d' , $nuevafecha );
                }?>
          </tr>
          <?php }?>

          </table>
        
        </div>
      </div>
    </section>
  </div>
</div>
<div style="display:none" id="horaregistrada"></div>
<div style="display:none" id="carga"></div>
<div style="display:none" id="carga_nueva"></div>
<div style="display:none" id="carga_w1"></div>


<script type="text/javascript">
function fnc(evt) {
    var evt = evt.target ? evt : window.event;
    if (!evt.target) { evt.target = evt.srcElement; }
    var hora = $("#horaregistrada").text();
    values="-";
    $("#horaregistrada").text( values ); 
    var variables_input=evt.target.id;
    //alert(variables_input);
    var hora_real = parseInt(hora);
    var array_variables = variables_input.split("!");  
    var codigo_prop_proy=array_variables[0];
    var codigo_actividad=array_variables[1];
    var actividadid=array_variables[2];
    var revision=array_variables[3];
    var actividad_padre=array_variables[4];
    var proyectoid=array_variables[5];
    var semanaid=array_variables[6];
    var fecha_tarea =array_variables[7];
    var asignado=array_variables[8];
    var areaid=array_variables[9];
    var categoriaid =array_variables[10];
    var dni=array_variables[11];
    var cargo=array_variables[12];
    var tipo_actividad=array_variables[13];
    var etapa=array_variables[14];
    var fecha_imprimir=array_variables[15];
    var actividad_generalid=array_variables[16];

     

    
    if (isNaN(hora_real)) {
    var hora_real='0';
    }
    //else{
    //var horasumanew=parseInt(horasuma);
    //}

    if (isNaN(hora_real)) {


    }
    else
    {
      var url="/timesheet/index/updatetareoreal/codigo_prop_proy/"+codigo_prop_proy+"/codigo_actividad/"+codigo_actividad+"/actividadid/"+actividadid+"/revision/"+revision+"/actividad_padre/"+actividad_padre+"/proyectoid/"+proyectoid+"/semanaid/"+semanaid+"/fecha_tarea/"+fecha_tarea+"/asignado/"+asignado+"/areaid/"+areaid+"/categoriaid/"+categoriaid+"/dni/"+dni+"/cargo/"+cargo+"/horareal/"+hora_real+"/tipo_actividad/"+tipo_actividad+"/etapa/"+etapa+"/actividad_generalid/"+actividad_generalid;
      //alert(url);
      //$("#carga").load(url);
    
     var dateObj = new Date();
                    var dateFrom = $.datepicker.formatDate('mm/dd/yy', dateObj);
                    var weekfrom = $.datepicker.iso8601Week(new Date(dateFrom));
                    var diasSemana = new Array("Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado");
                    var day_select = diasSemana[dateObj.getDay()];
                    for (i = 0; i < diasSemana.length; i++) { 
                      if (diasSemana[i] == day_select) {
                        if (i == 0) {
                          var num_day = 6;
                        } else {
                          var num_day = i - 1;
                        };
                      };
                    };
                    fecha_inicio = mostrarFecha(dateObj,-num_day);
                    //document.location.href="/timesheet/index/calendar";
    }

}

$( "input" )
  .keyup(function() {
  var value = $( this ).val();
  $("#horaregistrada").text( value );

})

$("#submit_work").click(function(){
  alert("Enviando Hoja de Tiempo para Aprobacion");
  var fecha="<?php echo $this->fecha?>";
  var semana="<?php echo $this->semana?>";
  var fecha_calendario = $("#fechasemana").text();
  
  var url="/timesheet/index/enviartimesheet/fecha_calendario/"+fecha_calendario;
  $("#carga_nueva").load(url);

});

</script>