<div ng-app="reporteApp" ng-controller="mainController as reporte" class="div-reportes">
	<h1>Reporte Tareopersona</h1>
	<div>
		<div>
			<div class="col-lg-6">
				<h4>Clientes</h4>
				<select class="form-control m-bot15" ng-model="reporte.cliente_seleccionado" ng-change="reporte.getProyectos(reporte.cliente_seleccionado, 'byCliente')">
					<option value="todos">Todos</option>
					<option value="{{cliente.id}}" ng-repeat="cliente in reporte.clientes track by $index">{{cliente.nombre}}</option>
				</select>
			</div>
			<div class="col-lg-6">
				<h4>Gerentes</h4>
				<select class="form-control m-bot15" ng-model="reporte.gerente_seleccionado" ng-change="reporte.getProyectos(reporte.gerente_seleccionado, 'byGerente')">
					<option value="todos">Todos</option>
					<option value="{{gerente.gerente_proyecto}}" ng-repeat="gerente in reporte.gerentes track by $index">{{gerente.gerente_proyecto}}</option>
				</select>
			</div>
			
			<div class="col-lg-12">
				<h4>Proyectos</h4>
				{{reporte.text_proyectos}}
				<table>
					<tr ng-repeat="proyecto in reporte.proyectos">
						<th>{{proyecto.nombre_proyecto}}</th>
						<th><input ng-model="reporte.proyectos[$index].selected" ng-change="reporte.getUsuarios(proyecto.codigo_prop_proy, $index)" ng-true-value="true" ng-false-value="false" type="checkbox"></th>
					</tr>
			</table>
			</div>			
		
		</div>
		<div class="col-lg-4">
			<h4>Usuarios</h4>
			<select ng-disabled="reporte.select_usuarios" class="form-control m-bot15" ng-model="reporte.usuario_seleccionado" ng-change="reporte.getTareopersona(reporte.usuario_seleccionado)">
				<option value="todos" selected="selected">Todos</option>
				<option value="{{usuario.uid}}" ng-repeat="usuario in reporte.usuarios track by $index">{{usuario.uid}}</option>
			</select>
		</div>
		<div class="col-lg-4">
			<h4>Cobrabilidad</h4>
			<input ng-disabled="reporte.not_tareopersona" type="checkbox" ng-model="reporte.tipo_todo" ng-true-value="true" ng-false-value="false" ng-click="reporte.mostrarTodo()">Todos
			<div ng-repeat="item in reporte.cobrabilidad">
				<input ng-disabled="reporte.not_tareopersona" type="checkbox" ng-model="reporte.activo[item.text]" ng-true-value="true" ng-false-value="false" ng-click="reporte.notTodo()">{{item.text}}
			</div>
		</div>
		<div class="col-lg-4">
			<h4>Rango Fecha de Rendición</h4>
			<div class="col-md-3 col-xs-11">
				<div data-date-viewmode="years" data-date-format="dd-mm-yyyy" data-date="12-02-2012"  class="input-append date dpYears">
                	<input type="text" readonly="" value="12-02-2012" size="16" class="form-control">
                    	<span class="input-group-btn add-on">
                    	<button class="btn btn-danger" type="button"><i class="fa fa-calendar"></i></button>
                    	</span>
            		</div>
            	<span class="help-block">Seleccione fecha inicial</span>
        	</div>
        	<div class="col-md-3 col-xs-11">
				<div data-date-viewmode="years" data-date-format="dd-mm-yyyy" data-date="12-02-2012"  class="input-append date dpYears">
                	<input type="text" readonly="" value="12-02-2012" size="16" class="form-control">
                    	<span class="input-group-btn add-on">
                    	<button class="btn btn-danger" type="button"><i class="fa fa-calendar"></i></button>
                    	</span>
            		</div>
            	<span class="help-block">Seleccione fecha final</span>
        	</div>
		</div>
	</div>
	<div>
		<table class="table table-bordered table-striped table-condensed">
		<thead class="">
			<th>
				<div>
					Usuario Id
				</div>
			</th>
			<th>
				<div>
					Usuario
				</div>
			</th>
			<th>
				<div>
					Rate del proyecto
				</div>
			</th>
			<th>
				<div>
					Código de Proyecto
				</div>
			</th>
			<th>
				<div>
					Cobrable/No Cobrable
				</div>
			</th>
			<th>
				<div>
					Proyecto (Unidad minera - proyecto)
				</div>
			</th>
			<th>
				<div>
					Status Proyecto
				</div>
			</th>
			<th ng-repeat="dia in reporte.dias">
				<div>
					{{dia}}
				</div>
			</th>
			<th>
				<div>
					Full Sumary
				</div>
			</th>
		</thead>
		<tbody class="">
			<tr ng-repeat="fila in reporte.tareopersona" ng-show="reporte.activo[fila.tipo_actividad]">
				<td>
					<div>
						{{fila.dni}}
					</div>
				</td>
				<td>
					<div>
						{{fila.uid}}
					</div>
				</td>
				<td>
					<div>
						{{fila.rate}}
					</div>
				</td>
				<td>
					<div>
						{{fila.proyectoid}}
					</div>
				</td>
				<td>
					<div>
						{{fila.tipo_actividad}}
					</div>
				</td>
				<td>
					<div>
						{{fila.nombre + ' / ' +fila.nombre_proyecto}}
					</div>
				</td>
				<td>
					<div>
						{{fila.estado}}
					</div>
				</td>
				<td ng-repeat="dia in reporte.dias">
					<div>
						
					</div>
				</td>
				<td>
					<div>
						{{fila.summary}}
					</div>
				</td>
			</tr>
		</tbody>
		<tfoot class="">
			<td>
				<div>
					Full Summary
				</div>
			</td>
			<td>
				<div></div>
			</td>
			<td>
				<div></div>
			</td>
			<td>
				<div></div>
			</td>
			<td>
				<div></div>
			</td>
			<td>
				<div></div>
			</td>
			<td>
				<div></div>
			</td>
			<td ng-repeat="dia in reporte.dias">
				<div>
					
				</div>
			</td>
			<td>
				<div></div>
			</td>
		</tfoot>	
		</table>
	</div>
	<div class="row-fluid">
		<div class="span6">
			<div class="dataTables_info">Showing 1 to 10 of 57 entries</div>
		</div>
		<div class="span6">
			<div class="dataTables_paginate paging_bootstrap pagination">
				<ul>
					<li class="prev disabled"><a href="#">← Previous</a></li>
					<li class="active"><a href="#">1</a></li>
					<li><a href="#">2</a></li>
					<li><a href="#">3</a></li>
					<li><a href="#">4</a></li>
					<li><a href="#">5</a></li>
					<li class="next"><a href="#">Next → </a></li>
				</ul>
			</div>
		</div>
	</div>

</div>

<!--script>
  //Funcion para poner el scroll personalizado a las tablas
  $('#usuarioScroll').ready(function ($) {
    //$('.bodyScroll').addClass('scrollContent');
    $('#usuarioScroll').perfectScrollbar();
  });
</script-->


<!--div de modal para barra cargando-->
<div class="modal fade" id="wait" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
  <div class="modal-dialog">
      <div class="modal-content">
          <div class="modal-body">
			<img src="/img/ico-loading.gif" alt="">
          </div>
      </div>
  </div>
</div>

<script>
	 if (top.location != location) {
        top.location.href = document.location.href ;
    }
    $(function(){
        window.prettyPrint && prettyPrint();
        $('.default-date-picker').datepicker({
            format: 'mm-dd-yyyy',
            autoclose: true
        });
        $('.dpYears').datepicker({
            autoclose: true
        });
        $('.dpMonths').datepicker({
            autoclose: true
        });


        var startDate = new Date(2012,1,20);
        var endDate = new Date(2012,1,25);
        $('.dp4').datepicker()
            .on('changeDate', function(ev){
                if (ev.date.valueOf() > endDate.valueOf()){
                    $('.alert').show().find('strong').text('The start date can not be greater then the end date');
                } else {
                    $('.alert').hide();
                    startDate = new Date(ev.date);
                    $('#startDate').text($('.dp4').data('date'));
                }
                $('.dp4').datepicker('hide');
            });
        $('.dp5').datepicker()
            .on('changeDate', function(ev){
                if (ev.date.valueOf() < startDate.valueOf()){
                    $('.alert').show().find('strong').text('The end date can not be less then the start date');
                } else {
                    $('.alert').hide();
                    endDate = new Date(ev.date);
                    $('.endDate').text($('.dp5').data('date'));
                }
                $('.dp5').datepicker('hide');
            });

        // disabling dates
        var nowTemp = new Date();
        var now = new Date(nowTemp.getFullYear(), nowTemp.getMonth(), nowTemp.getDate(), 0, 0, 0, 0);

        var checkin = $('.dpd1').datepicker({
            onRender: function(date) {
                return date.valueOf() < now.valueOf() ? 'disabled' : '';
            }
        }).on('changeDate', function(ev) {
                if (ev.date.valueOf() > checkout.date.valueOf()) {
                    var newDate = new Date(ev.date)
                    newDate.setDate(newDate.getDate() + 1);
                    checkout.setValue(newDate);
                }
                checkin.hide();
                $('.dpd2')[0].focus();
            }).data('datepicker');
        var checkout = $('.dpd2').datepicker({
            onRender: function(date) {
                return date.valueOf() <= checkin.date.valueOf() ? 'disabled' : '';
            }
        }).on('changeDate', function(ev) {
                checkout.hide();
            }).data('datepicker');
    });



$(".form_datetime").datetimepicker({
    format: 'yyyy-mm-dd hh:ii',
    autoclose: true,
    todayBtn: true,
    pickerPosition: "bottom-left"

});


$(".form_datetime-component").datetimepicker({
    format: "dd MM yyyy - hh:ii",
    autoclose: true,
    todayBtn: true,
    pickerPosition: "bottom-left"
});

$(".form_datetime-adv").datetimepicker({
    format: "dd MM yyyy - hh:ii",
    autoclose: true,
    todayBtn: true,
    startDate: "2013-02-14 10:00",
    minuteStep: 10,
    pickerPosition: "bottom-left"

});

$(".form_datetime-meridian").datetimepicker({
    format: "dd MM yyyy - HH:ii P",
    showMeridian: true,
    autoclose: true,
    todayBtn: true,
    pickerPosition: "bottom-left"
});
</script>